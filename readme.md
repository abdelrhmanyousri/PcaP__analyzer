# PcaP__analyzer

analyazing pcap  files and get  Host IP, Operating System, Open Ports, Identified Protocols.

### Prerequisites

python 2.7 

install scapy from here [here](https://scapy.readthedocs.io/en/latest/installation.html)

install prettytable form [here](https://pypi.org/project/PrettyTable/)

### how to use ?

you just download it from github and run it `python tool.py <input_file_directory>`


### Output 

A table of four columns Host IP , Operating system , open ports and Identified protocols ordered based on the number of open ports on each host.


### Example of use 
	
	 
	python tool.py /home/yousri/test.pcap
			
	+-----------------+------------------+------------+----------------------+
	|     Host ip     | Operating system | open ports | Identified Protocols |
	+-----------------+------------------+------------+----------------------+
	|    0.168.1.2    |     Windows      |    2783    |         UDP          |
	|   102.168.1.1   |     unknown      |     53     |         UDP          |
	|  107.168.1.255  |     unknown      |    137     |         UDP          |
	|    115.0.1.2    |     Windows      |    2798    |         UDP          |
	|    115.0.1.41   |     Windows      |    137     |         UDP          |
	|   116.168.1.2   |     Windows      |    2829    |         UDP          |
	|  120.168.1.255  |     unknown      |    137     |         UDP          |
	|   128.168.1.1   |     unknown      |     53     |         UDP          |
	|   128.168.1.2   |     Windows      |    2810    |         UDP          |
	|    14.168.1.2   |     Windows      |    2754    |         UDP          |
	|  147.117.1.253  |     unknown      |     21     |         TCP          |
	|  147.137.21.122 |     unknown      |    139     |         TCP          |
	|  147.234.1.170  |      Linux       |   43690    |         TCP          |
	|  147.234.1.249  |      Linux       |    2069    |         TCP          |
	| 170.170.170.170 |    Solaris 7     |   43690    |         UDP          |
	|                 |                  |            |         TCP          |
	|                 |                  |            |                      |
	|   172.168.1.2   |     Windows      |    2734    |         UDP          |
	|   192.112.1.2   |     Windows      |    2720    |         TCP          |
	|   192.114.1.2   |     Windows      |    2719    |         UDP          |
	|   192.121.1.2   |     Windows      |   26996    |         UDP          |
	|   192.136.1.1   |     unknown      |     53     |         UDP          |
	|   192.136.1.2   |     Windows      |    137     |         UDP          |
	|  192.168.1.112  |     unknown      |    137     |         UDP          |
	|  192.168.1.114  |     unknown      |     53     |         UDP          |
	|  192.168.1.129  |     unknown      |     53     |         UDP          |
	|   192.168.1.17  |     unknown      |     53     |         UDP          |
	|  192.168.1.170  |     Windows      |   43690    |         UDP          |
	|  192.168.1.172  |     Windows      |    2766    |         UDP          |
	|   192.168.1.18  |     Windows      |    2751    |         UDP          |
	|  192.168.1.202  |     Windows      |    137     |         UDP          |
	|  192.168.1.251  |     unknown      |    138     |         UDP          |
	|   192.168.1.34  |     Windows      |    2746    |         UDP          |
	|   192.168.1.37  |     unknown      |    137     |         UDP          |
	|   192.168.1.46  |      Linux       |     53     |         UDP          |
	|   192.168.1.52  |     Windows      |    5060    |         UDP          |
	|   192.168.1.53  |     Windows      |    2791    |         UDP          |
	|   192.168.1.57  |     Windows      |    2771    |         UDP          |
	|   192.168.1.66  |     unknown      |    2720    |         TCP          |
	|   192.168.1.71  |   Windows 2000   |    2718    |         TCP          |
	|  192.168.108.1  |     unknown      |     53     |         UDP          |
	|  192.168.115.1  |     unknown      |     53     |         UDP          |
	|  192.168.119.2  |     unknown      |    2799    |         UDP          |
	|  192.168.130.1  |      Linux       |     53     |         UDP          |
	|   192.168.17.1  |     unknown      |     53     |         UDP          |
	| 192.168.170.170 |     Windows      |   43690    |         UDP          |
	|  192.168.233.1  |      Linux       |     53     |         UDP          |
	|   192.168.3.1   |     unknown      |     53     |         UDP          |
	|   192.168.33.2  |     Windows      |    2782    |         UDP          |
	|   192.168.5.2   |     unknown      |    2784    |         UDP          |
	|   192.168.54.2  |     Windows      |    2829    |         UDP          |
	|   192.168.65.2  |     unknown      |    2720    |         TCP          |
	|   192.168.67.1  |     unknown      |     53     |         UDP          |
	|   192.168.79.2  |     Windows      |    2791    |         UDP          |
	|   192.168.84.1  |     unknown      |     53     |         UDP          |
	|   192.168.9.2   |     Windows      |    2774    |         UDP          |
	|   192.170.1.1   |     unknown      |     53     |         UDP          |
	|   192.170.1.2   |     Windows      |    2810    |         UDP          |
	| 192.170.170.170 |     unknown      |   43690    |         UDP          |
	|   192.184.1.1   |     unknown      |     53     |         UDP          |
	|  192.184.189.41 |     Windows      |    137     |         UDP          |
	|  192.194.1.255  |     unknown      |    137     |         UDP          |
	|    192.2.1.2    |     unknown      |    2720    |         TCP          |
	|    192.22.1.2   |     Windows      |    2760    |         UDP          |
	|   192.232.1.2   |     unknown      |    2721    |         TCP          |
	|   192.232.1.41  |     Windows      |    137     |         UDP          |
	|    192.86.1.2   |     Windows      |    5060    |         UDP          |
	|    192.98.1.2   |     Windows      |    2752    |         UDP          |
	|  200.168.1.255  |     unknown      |    137     |         UDP          |
	|  200.68.120.99  |     unknown      |    5060    |         UDP          |
	|  200.68.37.115  |     unknown      |    5060    |         UDP          |
	|  208.242.33.35  |      Linux       |    5060    |         UDP          |
	|  212.234.33.35  |     unknown      |    5060    |         UDP          |
	|  212.242.33.201 |     unknown      |    5060    |         UDP          |
	|  212.242.33.36  |     unknown      |   40392    |         UDP          |
	|  214.242.33.36  |     unknown      |   40392    |         UDP          |
	|   217.168.1.2   |     Windows      |    137     |         UDP          |
	|   240.168.1.2   |     unknown      |    2792    |         UDP          |
	|   241.168.1.2   |     Windows      |   31074    |         UDP          |
	|    25.168.1.1   |     unknown      |     53     |         UDP          |
	|   253.168.1.1   |      Linux       |     53     |         UDP          |
	|    37.115.0.2   |     Windows      |    2639    |         TCP          |
	|   37.115.0.253  |      Linux       |   58999    |         TCP          |
	|   37.115.0.36   |     unknown      |   40392    |         UDP          |
	|    62.168.1.2   |     Windows      |    137     |         UDP          |
	|    67.168.1.1   |     unknown      |     53     |         UDP          |
	|    81.168.1.2   |     Windows      |   30000    |         UDP          |
	|    84.168.1.2   |     unknown      |    2720    |         TCP          |
	|    94.168.1.2   |     Windows      |    2768    |         UDP          |
	|  147.137.21.94  |     unknown      |    139     |         TCP          |
	|                 |                  |    445     |                      |
	|  192.168.1.110  |     Windows      |    2713    |         UDP          |
	|                 |                  |    2765    |                      |
	|   192.168.1.3   |     Windows      |   30000    |         UDP          |
	|                 |                  |     53     |                      |
	|   192.168.1.41  |     Windows      |    137     |         UDP          |
	|                 |                  |    138     |                      |
	|   192.168.1.6   |     Windows      |    2721    |         UDP          |
	|                 |                  |    5060    |         TCP          |
	|  192.168.37.115 |     Windows      |    137     |         UDP          |
	|                 |                  |    2758    |                      |
	|   192.169.1.2   |     Windows      |    2720    |         UDP          |
	|                 |                  |    5060    |         TCP          |
	|   192.37.115.0  |     unknown      |    5060    |         UDP          |
	|                 |                  |     53     |                      |
	|   200.168.1.2   |     Windows      |    2785    |         UDP          |
	|                 |                  |    2735    |                      |
	|  200.68.120.81  |      Linux       |   29440    |         UDP          |
	|                 |                  |    5060    |         STP          |
	|                 |                  |    4932    |                      |
	|  212.242.33.35  |      Linux       |   17860    |         UTI          |
	|                 |                  |    9587    |         UDP          |
	|                 |                  |    5060    |        HOPOPT        |
	|                 |                  |   31022    |                      |
	|  147.234.1.253  |      Linux       |   49964    |         TCP          |
	|                 |                  |     21     |                      |
	|                 |                  |   58999    |                      |
	|                 |                  |    120     |                      |
	|                 |                  |   47645    |                      |
	|                 |                  |    1045    |                      |
	|  192.168.1.255  |     unknown      |    8329    |        HOPOPT        |
	|                 |                  |    138     |         UDP          |
	|                 |                  |   25481    |                      |
	|                 |                  |   35721    |                      |
	|                 |                  |    905     |                      |
	|                 |                  |    137     |                      |
	|                 |                  |    169     |                      |
	|                 |                  |    394     |                      |
	|   192.168.1.1   |      Linux       |   29440    |        HOPOPT        |
	|                 |                  |     51     |         DDP          |
	|                 |                  |     67     |         UDP          |
	|                 |                  |     4      |       DCN-MEAS       |
	|                 |                  |   43690    |        CRUDP         |
	|                 |                  |    2403    |                      |
	|                 |                  |     21     |                      |
	|                 |                  |   38709    |                      |
	|                 |                  |   25970    |                      |
	|                 |                  |    9587    |                      |
	|                 |                  |     53     |                      |
	|                 |                  |    117     |                      |
	|                 |                  |   49973    |                      |
	|   192.168.1.2   |   Windows 2000   |    2816    |        HOPOPT        |
	|                 |                  |    2568    |         DDP          |
	|                 |                  |     11     |         TCP          |
	|                 |                  |    2572    |         UDP          |
	|                 |                  |    2597    |       DCN-MEAS       |
	|                 |                  |     68     |         STP          |
	|                 |                  |    2640    |         UTI          |
	|                 |                  |     88     |        CRUDP         |
	|                 |                  |   10942    |                      |
	|                 |                  |    2679    |                      |
	|                 |                  |    2684    |                      |
	|                 |                  |    137     |                      |
	|                 |                  |    138     |                      |
	|                 |                  |    2712    |                      |
	|                 |                  |    196     |                      |
	|                 |                  |    2714    |                      |
	|                 |                  |    2715    |                      |
	|                 |                  |    156     |                      |
	|                 |                  |    2717    |                      |
	|                 |                  |    2718    |                      |
	|                 |                  |    2719    |                      |
	|                 |                  |    2720    |                      |
	|                 |                  |    2721    |                      |
	|                 |                  |    2722    |                      |
	|                 |                  |    2723    |                      |
	|                 |                  |    2724    |                      |
	|                 |                  |    2725    |                      |
	|                 |                  |    2726    |                      |
	|                 |                  |   43690    |                      |
	|                 |                  |    2732    |                      |
	|                 |                  |    2733    |                      |
	|                 |                  |    2734    |                      |
	|                 |                  |    2735    |                      |
	|                 |                  |    2736    |                      |
	|                 |                  |    2737    |                      |
	|                 |                  |    2738    |                      |
	|                 |                  |    2739    |                      |
	|                 |                  |    2740    |                      |
	|                 |                  |    2741    |                      |
	|                 |                  |    2742    |                      |
	|                 |                  |    2743    |                      |
	|                 |                  |    2744    |                      |
	|                 |                  |    2745    |                      |
	|                 |                  |    2746    |                      |
	|                 |                  |    2747    |                      |
	|                 |                  |    2748    |                      |
	|                 |                  |    2749    |                      |
	|                 |                  |    2750    |                      |
	|                 |                  |    2751    |                      |
	|                 |                  |    2752    |                      |
	|                 |                  |    2753    |                      |
	|                 |                  |    2754    |                      |
	|                 |                  |    2755    |                      |
	|                 |                  |    4292    |                      |
	|                 |                  |    2757    |                      |
	|                 |                  |    2758    |                      |
	|                 |                  |    2759    |                      |
	|                 |                  |    2760    |                      |
	|                 |                  |    2761    |                      |
	|                 |                  |    2762    |                      |
	|                 |                  |    2763    |                      |
	|                 |                  |    2764    |                      |
	|                 |                  |    2765    |                      |
	|                 |                  |    2766    |                      |
	|                 |                  |    2767    |                      |
	|                 |                  |   35536    |                      |
	|                 |                  |    2769    |                      |
	|                 |                  |    2770    |                      |
	|                 |                  |    2771    |                      |
	|                 |                  |    2772    |                      |
	|                 |                  |    2773    |                      |
	|                 |                  |    2774    |                      |
	|                 |                  |    2775    |                      |
	|                 |                  |    2776    |                      |
	|                 |                  |    2782    |                      |
	|                 |                  |    2783    |                      |
	|                 |                  |    2784    |                      |
	|                 |                  |    2785    |                      |
	|                 |                  |    2786    |                      |
	|                 |                  |    2787    |                      |
	|                 |                  |    2788    |                      |
	|                 |                  |    2789    |                      |
	|                 |                  |    2790    |                      |
	|                 |                  |    2791    |                      |
	|                 |                  |    2792    |                      |
	|                 |                  |    2793    |                      |
	|                 |                  |    2794    |                      |
	|                 |                  |    2795    |                      |
	|                 |                  |    2796    |                      |
	|                 |                  |    2797    |                      |
	|                 |                  |    2798    |                      |
	|                 |                  |    2799    |                      |
	|                 |                  |    2800    |                      |
	|                 |                  |    2801    |                      |
	|                 |                  |    2802    |                      |
	|                 |                  |    2803    |                      |
	|                 |                  |    2804    |                      |
	|                 |                  |    2805    |                      |
	|                 |                  |    2806    |                      |
	|                 |                  |    2807    |                      |
	|                 |                  |    2808    |                      |
	|                 |                  |    2809    |                      |
	|                 |                  |    2810    |                      |
	|                 |                  |    2811    |                      |
	|                 |                  |    2812    |                      |
	|                 |                  |    2813    |                      |
	|                 |                  |    2814    |                      |
	|                 |                  |    2815    |                      |
	|                 |                  |   29440    |                      |
	|                 |                  |    2822    |                      |
	|                 |                  |    2823    |                      |
	|                 |                  |    2824    |                      |
	|                 |                  |    2825    |                      |
	|                 |                  |    2826    |                      |
	|                 |                  |    2827    |                      |
	|                 |                  |    2828    |                      |
	|                 |                  |    2829    |                      |
	|                 |                  |    2830    |                      |
	|                 |                  |    2831    |                      |
	|                 |                  |    2832    |                      |
	|                 |                  |   58657    |                      |
	|                 |                  |    4901    |                      |
	|                 |                  |   30000    |                      |
	|                 |                  |    2756    |                      |
	|                 |                  |   26992    |                      |
	|                 |                  |    2713    |                      |
	|                 |                  |    5060    |                      |
	|                 |                  |   44957    |                      |
	|                 |                  |    2716    |                      |
	|                 |                  |   18162    |                      |
	|                 |                  |    2768    |                      |
	|                 |                  |    2208    |                      |
	|                 |                  |   20932    |                      |
	|                 |                  |   14798    |                      |
	|                 |                  |   19192    |                      |
	|                 |                  |    2730    |                      |
	+-----------------+------------------+------------+----------------------+

